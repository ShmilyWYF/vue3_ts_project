import"./vue.8f0363a6.js";import{_ as B,s as j,b as q}from"./index.vite.f0e544cd.js";import"./mavon-Editor.a6b8cb83.js";/* empty css                     */import{S as te}from"./index.1b779e5b.js";import{u as K}from"./vue-router.868db7b0.js";import{a as f}from"./element-plus.496f9954.js";import{G as w,z as y,d as T,ag as R,o as d,c as I,U as C,a as n,P as F,aj as Z,O as x,bf as N,be as O,_ as k,Z as J,u as o,T as U,H as ne,a0 as Q,V as S,M as b,R as M,E as A,F as V,a7 as P,S as oe,h as se,i as ae,K as re}from"./@vue.164e6201.js";const X=s=>(N("data-v-846cb82e"),s=s(),O(),s),le={class:"commentForm-box"},ie={class:"comment"},ce={style:{"text-align":"right"}},ue=X(()=>n("span",null,"Add Comment",-1)),me=X(()=>n("hr",null,null,-1)),de=w({__name:"index",props:{avatar:{type:String,required:!1,default:"src/assets/commentDefaultAvater.png"}},emits:["callObjectType","callListIndex"],setup(s,{emit:c}){const a=y("commentType"),p=y("commentReview"),t=y("userinfo"),e=y("saveComment"),l=T(""),r=K().path.split("/")[2],_=async()=>{if((t==null?void 0:t.value)==null){f({title:"Warning",message:"\u8BF7\u767B\u9646\u540E\u8BC4\u8BBA",type:"warning"});return}if(l.value.trim()===""&&l.value.length===0){f({title:"Warning",message:"\u8BF7\u8F93\u5165\u8BC4\u8BBA\u5185\u5BB9",type:"warning"});return}const h={commentContent:l.value,type:a,userId:t.value.id,topicId:r};c("callListIndex",void 0),await e(h).then(()=>{p?f.warning("\u8BC4\u8BBA\u6210\u529F,\u6B63\u5728\u5BA1\u6838\u4E2D"):f.success("\u56DE\u590D\u6210\u529F")}),l.value="",D()},D=()=>{c("callObjectType","comment")};return(h,u)=>{const v=R("el-avatar"),m=R("el-button");return d(),I("div",le,[C(v,{size:50,src:h.avatar},null,8,["src"]),n("div",ie,[F(n("textarea",{"onUpdate:modelValue":u[0]||(u[0]=E=>l.value=E),cols:"30",placeholder:"Add comment...",rows:"5"},null,512),[[Z,l.value]]),n("div",ce,[C(m,{id:"submit-button",onClick:_},{default:x(()=>[ue]),_:1})]),me])])}}}),pe=B(de,[["__scopeId","data-v-846cb82e"],["__file","E:/vue3_ts_project/src/components/CommentModule/CommentForm/index.vue"]]),_e={class:"comment-item-box"},ve={class:"content-box"},Ce={class:"content"},ye=["innerHTML"],fe=w({__name:"index",props:{commentData:{type:Object,required:!0},index:{type:Number,required:!0}},setup(s){const c=s,{commentData:a,index:p}=k(c),t=J({replyContent:"add reply...",time:a.value.createTime,show:!1}),e=()=>{t.replyContent="add reply...",t.show=!1};return(l,i)=>{const r=R("el-avatar");return d(),I("div",null,[n("div",_e,[C(r,{size:50,src:o(a).avatar},null,8,["src"]),n("div",ve,[n("div",Ce,[n("p",{class:"commentContent",innerHTML:o(a).commentContent.replaceAll(`
`,"<br>")},null,8,ye),n("div",null,[n("span",null,U(o(a).nickname)+" | "+U(t.time),1),n("div",null,[n("span",{onClick:i[0]||(i[0]=_=>t.show=!0)},"Reply")])])]),C(Q,{name:"fade"},{default:x(()=>[ne(l.$slots,"childComment",{commentReplyData:o(a)},void 0,!0)]),_:3}),o(a).replys?F((d(),b(o(W),{key:0,index:o(p),initialContent:t.replyContent,parentId:o(a).id,replyUserId:o(a).userId,onCancelReply:e},null,8,["index","initialContent","parentId","replyUserId"])),[[S,t.show]]):M("v-if",!0)])]),o(a).replys?M("v-if",!0):F((d(),b(o(W),{key:0,index:o(p),initialContent:t.replyContent,parentId:o(a).id,replyUserId:o(a).userId,onCancelReply:e},null,8,["index","initialContent","parentId","replyUserId"])),[[S,t.show]])])}}}),G=B(fe,[["__scopeId","data-v-db2e08a0"],["__file","E:/vue3_ts_project/src/components/CommentModule/CommentItem/index.vue"]]),he={},g=s=>(N("data-v-b9ec4826"),s=s(),O(),s),be={class:"loading"},xe=g(()=>n("div",null,null,-1)),ge=g(()=>n("div",null,null,-1)),De=g(()=>n("div",null,null,-1)),Ie=g(()=>n("div",null,null,-1)),Be=g(()=>n("div",null,null,-1)),Re=g(()=>n("div",null,null,-1)),we=g(()=>n("div",null,null,-1)),Ee=g(()=>n("div",null,null,-1)),Ae=[xe,ge,De,Ie,Be,Re,we,Ee];function Fe(s,c){return d(),I("div",be,Ae)}const $e=B(he,[["render",Fe],["__scopeId","data-v-b9ec4826"],["__file","E:/vue3_ts_project/src/components/Animation/LoadingCircle/index.vue"]]),Me={class:"commentList-box"},Te=w({__name:"index",props:{commentData:{type:null,required:!0},haveMore:{type:Boolean,required:!0,skipCheck:!0}},emits:["callObjectType","callListIndex"],setup(s,{emit:c}){A("emitCall",(t,e)=>{c("callListIndex",e),c("callObjectType",t)});const a=async()=>{c("callObjectType","loadMore")},p=t=>t.sort((e,l)=>Date.parse(String(e.createTime))-Date.parse(String(l.createTime)));return(t,e)=>{const l=R("el-button");return d(),I("div",Me,[C(Q,{name:"fade"},{default:x(()=>[(d(!0),I(V,null,P(t.commentData,(i,r)=>(d(),b(o(G),{key:i.id,commentData:i,index:r},{childComment:x(_=>[(d(!0),I(V,null,P(p(_.commentReplyData.replys),D=>(d(),b(o(G),{commentData:D,index:r},null,8,["commentData","index"]))),256))]),_:2},1032,["commentData","index"]))),128))]),_:1}),t.haveMore?(d(),b(l,{key:0,class:"button-three",onClick:a},{default:x(()=>[oe(" Load More ")]),_:1})):F((d(),b(o($e),{key:1,style:{margin:"0 auto"}},null,512)),[[S,t.haveMore!=null]])])}}}),ke=B(Te,[["__scopeId","data-v-05ac0780"],["__file","E:/vue3_ts_project/src/components/CommentModule/CommentList/index.vue"]]),Y=s=>(N("data-v-4d5d51c4"),s=s(),O(),s),Le={class:"comment-reply-form"},je={class:"comment-content-box"},qe=["placeholder"],Se=Y(()=>n("span",null,"Cancel",-1)),Ne=Y(()=>n("span",null,"Reply",-1)),Oe=w({__name:"index",props:{replyUserId:{type:Number,required:!0},initialContent:{type:String,required:!0},parentId:{type:Number,required:!0},index:{type:Number,required:!0}},emits:["cancelReply"],setup(s,{emit:c}){const a=s,{initialContent:p,replyUserId:t,parentId:e,index:l}=k(a),i=T(""),_=K().path.split("/")[2],D=y("emitCall"),h=y("saveComment"),u=y("commentType"),v=y("commentReview"),m=y("userinfo"),E=async()=>{if(m===void 0){f.warning("\u8BF7\u767B\u9646\u540E\u8BC4\u8BBA~");return}if(i.value.trim()==""){f.warning("\u56DE\u590D\u4E0D\u80FD\u4E3A\u7A7A~");return}const L={type:u,replyUserId:t==null?void 0:t.value,parentId:e==null?void 0:e.value,commentContent:i.value,userId:m.id};L.topicId=_,c("cancelReply"),await D("callListIndex",l.value),await h(L),v?f.success("\u8BC4\u8BBA\u6210\u529F,\u6B63\u5728\u5BA1\u6838\u4E2D~"):f.success("\u56DE\u590D\u6210\u529F"),i.value=""};return(L,$)=>{const ee=R("el-avatar"),z=R("el-button");return d(),I("div",Le,[C(ee,{size:50,src:o(m)?o(m).avatar:"https://c-ssl.duitang.com/uploads/blog/202206/26/20220626195022_d538d.jpeg"},null,8,["src"]),n("div",je,[F(n("textarea",{"onUpdate:modelValue":$[0]||($[0]=H=>i.value=H),placeholder:o(p),cols:"30",rows:"5"},null,8,qe),[[Z,i.value]]),n("div",null,[C(z,{id:"submit-button",size:"small",type:"primary",onClick:$[1]||($[1]=H=>{i.value="",c("cancelReply")})},{default:x(()=>[Se]),_:1}),C(z,{id:"submit-button",size:"small",type:"success",onClick:E},{default:x(()=>[Ne]),_:1})])])])}}}),W=B(Oe,[["__scopeId","data-v-4d5d51c4"],["__file","E:/vue3_ts_project/src/components/CommentModule/CommentReplyForm/index.vue"]]),ze=w({__name:"index",props:{commentData:{type:null,required:!0},isHaveMore:{type:Boolean,required:!0,skipCheck:!0},type:{type:Number,required:!0},isCommentReview:{type:Number,required:!0},userinfo:{type:null,required:!0},commentsCall:{type:Function,required:!0},indexCall:{type:Function,required:!0},formAvatar:{type:String,required:!1},save:{type:Function,required:!0}},setup(s,{expose:c}){const a=s,{type:p,isCommentReview:t,userinfo:e,save:l}=k(a);A("commentType",p.value),A("commentReview",t.value),A("userinfo",e),A("saveComment",async r=>l.value(r));const i=T();return c({sidebarCommentRef:i}),(r,_)=>(d(),b(o(te),{ref_key:"sidebarCommentRef",ref:i,h:"auto",icon:"moon",title:"\u8BC4\u8BBA\u533A","ul-li-class":"sidebarClass"},{defulet:x(()=>[M("\u4EC5\u4E00\u5C42\u76F4\u63A5\u4F7F\u7528props\u5373\u53EF"),C(o(pe),{onCallObjectType:r.commentsCall,onCallListIndex:r.indexCall,avatar:r.formAvatar},null,8,["onCallObjectType","onCallListIndex","avatar"]),C(o(ke),{commentData:r.commentData,"have-more":r.isHaveMore,onCallObjectType:r.commentsCall,onCallListIndex:r.indexCall},null,8,["commentData","have-more","onCallObjectType","onCallListIndex"])]),_:1},512))}}),He=B(ze,[["__scopeId","data-v-6cfc6579"],["__file","E:/vue3_ts_project/src/components/CommentModule/index.vue"]]),Ue=w({__name:"index",props:{type:{type:Number,required:!0},id:{type:[Number,String],required:!1}},setup(s){var h;const c=s,{type:a,id:p}=k(c),t=T(!1);se(()=>{r()});const e=J({index:0,commentData:[],isHaveMore:void 0,current:1,size:7,isReload:!1,type:a,isCommentReview:j.getters.useState.websiteConfig.commentReview||0,userinfo:ae(()=>j.getters.userinfo||void 0),formAvatar:((h=j.getters.useState.userConfig)==null?void 0:h.avatar)||void 0}),l=u=>{e.index=u},i=u=>{switch(u){case"comment":e.current=1,e.isReload=!0,r();break;case"replies":_(e.index);break;case"loadMore":e.isHaveMore=!1,r();break}},r=()=>{const u={type:e.type,current:e.current,size:e.size,topicId:p==null?void 0:p.value};q.commentApi.getCommentListByType(u).then(v=>{const{data:m}=v.data;e.isReload?(e.commentData=m.commentList,e.isReload=!1):e.commentData.push(...m.commentList),m.count===e.commentData.length?e.isHaveMore=void 0:e.isHaveMore=m.count>e.commentData.length,e.current++}),t.value=!0},_=u=>{let v=e.commentData[u].id;q.commentApi.getRepliesByCommentId({id:v}).then(m=>{const{data:E}=m.data;e.commentData[u].replys=E.replys})},D=async u=>new Promise(v=>{q.commentApi.saveComments(u).then(()=>{e.index!=-1&&e.commentData[e.index]&&_(e.index),v("")},m=>{f.error("\u56DE\u590D\u6D88\u606F\u51FA\u73B0\u5F02\u5E38"+m.message)})});return(u,v)=>t.value?(d(),b(o(He),re({key:0,ref:"commentsRef"},e,{commentsCall:i,"index-call":l,save:D,style:{"margin-top":"1rem"}}),null,16)):M("v-if",!0)}}),Xe=B(Ue,[["__file","E:/vue3_ts_project/src/components/Comment/index.vue"]]);export{Xe as C};
